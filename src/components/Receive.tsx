import { ViewNames } from '@/pages';
import styles from '@/styles/Home.module.css';
import { formatAddress } from '@/utils/helpers';
import QRCode from 'qrcode.react';
import { useState } from 'react';
import { useWallet } from '../hooks/use-wallet';
import { BackTitle } from './Menu';

interface CopyProps {
  copyText: string;
  children: React.ReactElement;
  copyButtonStyles: string;
}

export const Copy: React.FunctionComponent<
  React.PropsWithChildren<CopyProps>
> = (props) => {
  const { children, copyText, copyButtonStyles } = props;
  const [showCopied, setShowCopied] = useState<boolean>(false);

  const copyToClipboard = () => {
    navigator.clipboard.writeText(copyText);
    setShowCopied(true);
    setTimeout(() => {
      setShowCopied(false);
    }, 5000); // 5000 milliseconds = 5 seconds
  };
  console.log({ showCopied });

  return (
    <div style={{ position: 'relative' }}>
      {showCopied && (
        <div
          style={{
            backgroundColor: 'white',
            position: 'absolute',
            top: -20,
            right: -10,
            borderRadius: 5,
            padding: 5,
          }}
        >
          Copied!
        </div>
      )}
      <button onClick={() => copyToClipboard()} className={copyButtonStyles}>
        {children}
      </button>
    </div>
  );
};

interface ReceiveProps {
  setCurrentView: React.Dispatch<React.SetStateAction<ViewNames>>;
}

export const Receive: React.FunctionComponent<
  React.PropsWithChildren<ReceiveProps>
> = (props) => {
  const { setCurrentView } = props;
  const { address } = useWallet();

  return (
    <div style={{ padding: 10 }}>
      <BackTitle title={'Receive'} onBack={() => setCurrentView('overview')} />
      <div style={{ height: 20 }} />
      <div className={styles.center}>
        <QRCode
          value={address}
          size={266}
          style={{ borderRadius: 5, backgroundColor: 'white', padding: 10 }}
        />
      </div>
      <div className={styles.spacer} />
      <div className={styles.spacer} />
      <div className={styles.center}>
        <Copy
          copyText={address}
          copyButtonStyles={`${styles.button_transparent}`}
        >
          <div className={`${styles.center}`}>
            <h4>{formatAddress(address, 6)}</h4>
            <div style={{ width: 5 }} />
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlnsXlink="http://www.w3.org/1999/xlink"
              width="20"
              zoomAndPan="magnify"
              viewBox="0 0 375 374.999991"
              height="20"
              preserveAspectRatio="xMidYMid meet"
              version="1.0"
            >
              <defs>
                <clipPath id="592617f25f">
                  <path
                    d="M 25.078125 0 L 349.828125 0 L 349.828125 375 L 25.078125 375 Z M 25.078125 0 "
                    clip-rule="nonzero"
                  />
                </clipPath>
              </defs>
              <g clip-path="url(#592617f25f)">
                <path
                  fill="#2c2a3f"
                  d="M 25.078125 337.429688 C 25.078125 338.65625 25.136719 339.878906 25.257812 341.101562 C 25.378906 342.324219 25.558594 343.535156 25.796875 344.738281 C 26.039062 345.945312 26.335938 347.132812 26.691406 348.308594 C 27.046875 349.484375 27.460938 350.636719 27.929688 351.773438 C 28.398438 352.90625 28.925781 354.015625 29.503906 355.097656 C 30.082031 356.179688 30.710938 357.230469 31.394531 358.25 C 32.074219 359.273438 32.804688 360.257812 33.582031 361.207031 C 34.363281 362.15625 35.183594 363.0625 36.054688 363.929688 C 36.921875 364.800781 37.828125 365.625 38.777344 366.402344 C 39.726562 367.179688 40.710938 367.910156 41.730469 368.59375 C 42.75 369.273438 43.804688 369.90625 44.886719 370.484375 C 45.96875 371.0625 47.074219 371.585938 48.210938 372.054688 C 49.34375 372.527344 50.496094 372.941406 51.671875 373.296875 C 52.847656 373.652344 54.035156 373.949219 55.238281 374.191406 C 56.441406 374.429688 57.65625 374.609375 58.875 374.730469 C 60.097656 374.851562 61.320312 374.910156 62.550781 374.910156 L 237.414062 374.910156 C 238.640625 374.910156 239.867188 374.851562 241.085938 374.730469 C 242.308594 374.609375 243.519531 374.429688 244.726562 374.191406 C 245.929688 373.949219 247.117188 373.652344 248.292969 373.296875 C 249.464844 372.941406 250.621094 372.527344 251.753906 372.058594 C 252.886719 371.585938 253.996094 371.0625 255.078125 370.484375 C 256.160156 369.90625 257.210938 369.273438 258.234375 368.59375 C 259.253906 367.910156 260.238281 367.179688 261.1875 366.402344 C 262.136719 365.625 263.042969 364.800781 263.910156 363.929688 C 264.777344 363.0625 265.601562 362.15625 266.378906 361.207031 C 267.160156 360.257812 267.890625 359.273438 268.570312 358.25 C 269.253906 357.230469 269.882812 356.179688 270.460938 355.097656 C 271.039062 354.015625 271.5625 352.90625 272.035156 351.773438 C 272.503906 350.636719 272.917969 349.484375 273.273438 348.308594 C 273.628906 347.132812 273.925781 345.945312 274.164062 344.738281 C 274.40625 343.535156 274.585938 342.324219 274.707031 341.101562 C 274.824219 339.878906 274.886719 338.65625 274.886719 337.429688 L 274.886719 324.933594 L 312.355469 324.933594 C 313.585938 324.933594 314.808594 324.875 316.03125 324.753906 C 317.25 324.632812 318.464844 324.453125 319.667969 324.214844 C 320.871094 323.972656 322.058594 323.675781 323.234375 323.320312 C 324.410156 322.964844 325.5625 322.550781 326.695312 322.082031 C 327.832031 321.609375 328.9375 321.085938 330.019531 320.507812 C 331.101562 319.929688 332.15625 319.300781 333.175781 318.617188 C 334.195312 317.933594 335.179688 317.203125 336.128906 316.425781 C 337.078125 315.648438 337.984375 314.824219 338.851562 313.957031 C 339.722656 313.085938 340.542969 312.179688 341.324219 311.230469 C 342.101562 310.28125 342.832031 309.296875 343.511719 308.277344 C 344.195312 307.253906 344.824219 306.203125 345.402344 305.121094 C 345.980469 304.039062 346.507812 302.929688 346.976562 301.796875 C 347.445312 300.660156 347.859375 299.507812 348.214844 298.332031 C 348.570312 297.15625 348.867188 295.96875 349.109375 294.765625 C 349.347656 293.558594 349.527344 292.347656 349.648438 291.125 C 349.769531 289.902344 349.828125 288.679688 349.828125 287.453125 L 349.828125 37.570312 C 349.828125 36.34375 349.769531 35.121094 349.648438 33.898438 C 349.527344 32.675781 349.347656 31.464844 349.109375 30.257812 C 348.867188 29.054688 348.570312 27.867188 348.214844 26.691406 C 347.859375 25.515625 347.445312 24.363281 346.976562 23.226562 C 346.507812 22.09375 345.980469 20.984375 345.402344 19.902344 C 344.824219 18.820312 344.195312 17.769531 343.511719 16.75 C 342.832031 15.726562 342.101562 14.742188 341.324219 13.792969 C 340.542969 12.84375 339.722656 11.9375 338.851562 11.066406 C 337.984375 10.199219 337.078125 9.375 336.128906 8.597656 C 335.179688 7.820312 334.195312 7.089844 333.175781 6.40625 C 332.15625 5.726562 331.101562 5.09375 330.019531 4.515625 C 328.9375 3.9375 327.832031 3.414062 326.695312 2.941406 C 325.5625 2.472656 324.410156 2.058594 323.234375 1.703125 C 322.058594 1.347656 320.871094 1.050781 319.667969 0.808594 C 318.464844 0.570312 317.25 0.390625 316.03125 0.269531 C 314.808594 0.148438 313.585938 0.0898438 312.355469 0.0898438 L 137.492188 0.0898438 C 136.265625 0.0898438 135.039062 0.148438 133.820312 0.269531 C 132.597656 0.390625 131.386719 0.570312 130.179688 0.808594 C 128.976562 1.050781 127.789062 1.347656 126.613281 1.703125 C 125.441406 2.058594 124.285156 2.472656 123.152344 2.941406 C 122.019531 3.414062 120.910156 3.9375 119.828125 4.515625 C 118.746094 5.09375 117.695312 5.726562 116.671875 6.40625 C 115.652344 7.089844 114.667969 7.820312 113.71875 8.597656 C 112.769531 9.375 111.863281 10.199219 110.996094 11.066406 C 110.128906 11.9375 109.304688 12.84375 108.527344 13.792969 C 107.746094 14.742188 107.015625 15.726562 106.335938 16.75 C 105.652344 17.769531 105.023438 18.820312 104.445312 19.902344 C 103.867188 20.984375 103.34375 22.09375 102.871094 23.226562 C 102.402344 24.363281 101.988281 25.515625 101.632812 26.691406 C 101.277344 27.867188 100.980469 29.054688 100.742188 30.257812 C 100.5 31.464844 100.320312 32.675781 100.199219 33.898438 C 100.082031 35.121094 100.019531 36.34375 100.019531 37.570312 L 100.019531 50.066406 L 62.550781 50.066406 C 61.320312 50.066406 60.097656 50.125 58.875 50.246094 C 57.65625 50.367188 56.441406 50.546875 55.238281 50.785156 C 54.035156 51.027344 52.847656 51.324219 51.671875 51.679688 C 50.496094 52.035156 49.34375 52.449219 48.210938 52.917969 C 47.074219 53.390625 45.96875 53.914062 44.886719 54.492188 C 43.804688 55.070312 42.75 55.699219 41.730469 56.382812 C 40.710938 57.066406 39.726562 57.796875 38.777344 58.574219 C 37.828125 59.351562 36.921875 60.175781 36.054688 61.042969 C 35.183594 61.914062 34.363281 62.820312 33.582031 63.769531 C 32.804688 64.71875 32.074219 65.703125 31.394531 66.722656 C 30.710938 67.746094 30.082031 68.796875 29.503906 69.878906 C 28.925781 70.960938 28.398438 72.070312 27.929688 73.203125 C 27.460938 74.339844 27.046875 75.492188 26.691406 76.667969 C 26.335938 77.84375 26.039062 79.03125 25.796875 80.234375 C 25.558594 81.441406 25.378906 82.652344 25.257812 83.875 C 25.136719 85.097656 25.078125 86.320312 25.078125 87.546875 Z M 125 37.570312 C 125 36.75 125.082031 35.9375 125.242188 35.132812 C 125.402344 34.328125 125.636719 33.546875 125.953125 32.789062 C 126.265625 32.03125 126.652344 31.3125 127.105469 30.628906 C 127.5625 29.949219 128.078125 29.316406 128.660156 28.738281 C 129.238281 28.15625 129.871094 27.640625 130.550781 27.183594 C 131.234375 26.726562 131.953125 26.34375 132.710938 26.027344 C 133.46875 25.714844 134.25 25.476562 135.054688 25.316406 C 135.859375 25.15625 136.671875 25.078125 137.492188 25.078125 L 312.355469 25.078125 C 313.175781 25.078125 313.988281 25.15625 314.792969 25.316406 C 315.597656 25.476562 316.378906 25.714844 317.136719 26.027344 C 317.894531 26.34375 318.613281 26.726562 319.296875 27.183594 C 319.976562 27.640625 320.609375 28.15625 321.1875 28.738281 C 321.769531 29.316406 322.285156 29.949219 322.742188 30.628906 C 323.199219 31.3125 323.582031 32.03125 323.898438 32.789062 C 324.210938 33.546875 324.449219 34.328125 324.605469 35.132812 C 324.765625 35.9375 324.847656 36.75 324.847656 37.570312 L 324.847656 287.453125 C 324.847656 288.273438 324.765625 289.085938 324.605469 289.890625 C 324.449219 290.695312 324.210938 291.476562 323.898438 292.234375 C 323.582031 292.992188 323.199219 293.710938 322.742188 294.394531 C 322.285156 295.074219 321.769531 295.707031 321.1875 296.285156 C 320.609375 296.867188 319.976562 297.382812 319.296875 297.839844 C 318.613281 298.296875 317.894531 298.679688 317.136719 298.996094 C 316.378906 299.308594 315.597656 299.546875 314.792969 299.707031 C 313.988281 299.867188 313.175781 299.945312 312.355469 299.945312 L 274.886719 299.945312 L 274.886719 87.546875 C 274.886719 86.320312 274.824219 85.097656 274.707031 83.875 C 274.585938 82.652344 274.40625 81.441406 274.164062 80.234375 C 273.925781 79.03125 273.628906 77.84375 273.273438 76.667969 C 272.917969 75.492188 272.503906 74.339844 272.035156 73.203125 C 271.5625 72.070312 271.039062 70.960938 270.460938 69.878906 C 269.882812 68.796875 269.253906 67.746094 268.570312 66.722656 C 267.890625 65.703125 267.160156 64.71875 266.378906 63.769531 C 265.601562 62.820312 264.777344 61.914062 263.910156 61.042969 C 263.042969 60.175781 262.136719 59.351562 261.1875 58.574219 C 260.238281 57.796875 259.253906 57.066406 258.234375 56.382812 C 257.210938 55.699219 256.160156 55.070312 255.078125 54.492188 C 253.996094 53.914062 252.886719 53.390625 251.753906 52.917969 C 250.621094 52.449219 249.464844 52.035156 248.292969 51.679688 C 247.117188 51.324219 245.929688 51.027344 244.726562 50.785156 C 243.519531 50.546875 242.308594 50.367188 241.085938 50.246094 C 239.867188 50.125 238.640625 50.066406 237.414062 50.066406 L 125 50.066406 Z M 50.058594 87.546875 C 50.058594 86.726562 50.140625 85.914062 50.300781 85.109375 C 50.457031 84.304688 50.695312 83.523438 51.007812 82.765625 C 51.324219 82.007812 51.707031 81.289062 52.164062 80.605469 C 52.621094 79.925781 53.136719 79.292969 53.71875 78.714844 C 54.296875 78.132812 54.929688 77.617188 55.609375 77.160156 C 56.292969 76.703125 57.011719 76.320312 57.769531 76.003906 C 58.527344 75.691406 59.308594 75.453125 60.113281 75.292969 C 60.917969 75.132812 61.730469 75.054688 62.550781 75.054688 L 237.414062 75.054688 C 238.234375 75.054688 239.046875 75.132812 239.851562 75.292969 C 240.65625 75.453125 241.4375 75.691406 242.195312 76.003906 C 242.953125 76.320312 243.671875 76.703125 244.355469 77.160156 C 245.035156 77.617188 245.667969 78.132812 246.246094 78.714844 C 246.828125 79.292969 247.34375 79.925781 247.800781 80.605469 C 248.253906 81.289062 248.640625 82.007812 248.953125 82.765625 C 249.269531 83.523438 249.503906 84.304688 249.664062 85.109375 C 249.824219 85.914062 249.90625 86.726562 249.90625 87.546875 L 249.90625 337.429688 C 249.90625 338.25 249.824219 339.0625 249.664062 339.867188 C 249.503906 340.667969 249.269531 341.449219 248.953125 342.210938 C 248.640625 342.96875 248.253906 343.6875 247.800781 344.367188 C 247.34375 345.050781 246.828125 345.683594 246.246094 346.261719 C 245.667969 346.84375 245.035156 347.359375 244.355469 347.816406 C 243.671875 348.273438 242.953125 348.65625 242.195312 348.972656 C 241.4375 349.285156 240.65625 349.523438 239.851562 349.683594 C 239.046875 349.839844 238.234375 349.921875 237.414062 349.921875 L 62.550781 349.921875 C 61.730469 349.921875 60.917969 349.839844 60.113281 349.683594 C 59.308594 349.523438 58.527344 349.285156 57.769531 348.972656 C 57.011719 348.65625 56.292969 348.273438 55.609375 347.816406 C 54.929688 347.359375 54.296875 346.84375 53.71875 346.261719 C 53.136719 345.683594 52.621094 345.050781 52.164062 344.367188 C 51.707031 343.6875 51.324219 342.96875 51.007812 342.210938 C 50.695312 341.449219 50.457031 340.667969 50.300781 339.867188 C 50.140625 339.0625 50.058594 338.25 50.058594 337.429688 Z M 50.058594 87.546875 "
                  fillOpacity="1"
                  fillRule="nonzero"
                />
              </g>
            </svg>
          </div>
        </Copy>
      </div>
    </div>
  );
};
